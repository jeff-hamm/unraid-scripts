#!/bin/bash
# Git post-checkout hook to set up bind mounts
# This runs after clone or checkout operations

# Only run for clone operations (when previous HEAD is all zeros)
PREV_HEAD=$1

if [ "$PREV_HEAD" = "0000000000000000000000000000000000000000" ]; then
  REPO_DIR="$(git rev-parse --show-toplevel)"
  BOOT_SCRIPT="$REPO_DIR/phome/boot.d/35-mount-git-repo.sh"
  
  if [ -x "$BOOT_SCRIPT" ]; then
    echo "Setting up bind mounts for unraid-scripts repo..."
    exec "$BOOT_SCRIPT"
  else
    echo "âš  Mount setup script not found or not executable: $BOOT_SCRIPT" >&2
    echo "You may need to manually set up bind mounts." >&2
    exit 1
  fi
fi
